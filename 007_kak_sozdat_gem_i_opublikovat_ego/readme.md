# –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å gem –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –µ–≥–æ

![image01](image01.jpeg)

## –í–≤–µ–¥–µ–Ω–∏–µ

–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã –∫–∞–∂–¥—ã–π ruby-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ (—Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ –≥–µ–º—ã). –ù–µ –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –≥–µ–º —Å –Ω—É–∂–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º, –≤ —Ç–∞–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–∏—Å–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –ß–∞—â–µ –≤—Å–µ–≥–æ —Ç–∞–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è –Ω–µ –≤—Ö–æ–¥—è—Ç –∑–∞ —Ä–∞–º–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞, –Ω–æ –∏–Ω–æ–≥–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–¥—É–º—ã–≤–∞—é—Ç—Å—è –æ —Ç–æ–º —á—Ç–æ–±—ã –æ–±–µ—Ä–Ω—É—Ç—å —Å–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ –≥–µ–º –∏ –ø–æ–¥–µ–ª–∏—Ç—Å—è –∏–º —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º.

–£ –º–µ–Ω—è –≤–æ–∑–Ω–∏–∫–ª–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–∏—Ç—å –º–µ—Ç–∞-—Ç–µ–≥–∏ –Ω–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ. –ù–∞–π–¥–µ–Ω–Ω—ã–µ –≥–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–ª–∏ –º–µ–Ω—è, –ø–æ—Ç–æ–º—É —è –Ω–∞–ø–∏—Å–∞–ª —Å–≤–æ–π –º–æ–¥—É–ª—å. –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å—á–∞—Å—Ç—å—è –Ω–µ —Ö–≤–∞—Ç–∞–ª–æ –æ–±–µ—Ä–Ω—É—Ç—å —Ä–µ—à–µ–Ω–∏–µ –≤ –≥–µ–º, —á–µ–º —è –∏ –∑–∞–Ω—è–ª—Å—è. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ —Å—Å—ã–ª–∫–µ:

[meta_information](https://github.com/kopylovvlad/meta_information)

–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –Ω–∞–ø–∏—Å–∞–Ω–æ —Å —Ü–µ–ª—å—é –ø–æ–º–æ—á—å –Ω–∞—á–∏–Ω–∞—é—â–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º. –û–Ω–æ —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ—Å–∫–∞–∑–æ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–ø—ã—Ç–∞. –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ —Å–∞–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ [http://guides.rubygems.org](http://guides.rubygems.org)

## –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã

–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ —Å –Ω—É–∂–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º. –¢–∞–∫ –∫–∞–∫ —Ä–µ—à–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ –º–æ–¥—É–ª—è, –µ–≥–æ —Å–ª–µ–¥—É–µ—Ç –ø–æ–ª–æ–∂–∏—Ç—å –≤ –ø–∞–ø–∫—É lib/

```ruby
# lib/meta_information.rb
require 'nokogiri'
require 'open-uri'

module MetaInformation
  class << self
    def get_meta(input_url)
      return not_valid_url_error unless valid_url?(input_url)

      document = create_document(input_url)
      return nokogiri_error if document == false

      meta_hash = create_meta_array(document)
      success_hash.merge(all_meta: meta_hash)
    end

    private

    def create_meta_array(document)
      array = []
      document.css('meta').each do |node|
        if !node['name'].nil?
          array.push(
            type: 'name',
            name: node['name'],
            content: node['content']
          )
        elsif !node['property'].nil?
          array.push(
            type: 'property',
            property: node['property'],
            content: node['content']
          )
        end
      end
      array
    end

    def valid_url?(uri)
      !!uri.match(/^(https?:\/\/)?([\w\.]+)\.([a-z]{2,6}\.?)(\/[\w\.]*)*\/?$/)
    end

    def create_document(input_url)
      Nokogiri::HTML(open(input_url))
    rescue
      false
    end

    def not_valid_url_error
      {
        success: false,
        error: 'url is not valid'
      }
    end

    def nokogiri_error
      {
        success: false,
        error: 'error with parsing a document'
      }
    end

    def success_hash
      {
        succes: 'true',
        error: ''
      }
    end
  end
end
```

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–µ–º Gemfile –∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º —Ç–∞–º –≤–µ—Ä—Å–∏—é ruby –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å—Ç–∞–≤–∏–º –∏—Ö —á–µ—Ä–µ–∑ bundle install.

```ruby
# Gemfile
source 'https://rubygems.org'
ruby '2.3.3'

gem 'nokogiri'
gem 'rspec'
```

–û—á–µ–Ω—å —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –Ω–∞–ø–∏—Å–∞—Ç—å —é–Ω–∏—Ç —Ç–µ—Å—Ç—ã. –û–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –ø–∞–ø–∫–µ test/ –∏–ª–∏ spec/

```ruby
# spec/lib/meta_information_spec.rb
require './lib/meta_information'

RSpec.describe 'MetaInformation' do
  
  describe 'create_meta_array' do
    describe 'we have meta' do
      it 'must create array' do
        document = Nokogiri::HTML('
          <html>
            <meta name="description" content="" />
            <meta name="title" content="some title" />
            <meta property="author" content="Bob" />
            <meta property="og:title" content="og_title" />
            <meta property="twitter:image" content="http://some_host.com/some_path" />
            <meta property="og:locale" content="ru_RU" />
            <meta property="al:ios:app_store_id" content="12345678900" />
            <body>
              <h1>Mr. Belvedere Fan Club</h1>
            </body>
          </html>
        ')
        expect(MetaInformation.send(:create_meta_array, document)).to eq([
          { type: 'name', name: 'description', content: '' },
          { type: 'name', name: 'title', content: 'some title' },
          { type: 'property', property: 'author', content: 'Bob' },
          { type: 'property', property: 'og:title', content: 'og_title' },
          { type: 'property', property: 'twitter:image', content: 'http://some_host.com/some_path' },
          { type: 'property', property: 'og:locale', content: 'ru_RU' },
          { type: 'property', property: 'al:ios:app_store_id', content: '12345678900' }
        ])
      end
    end
    
    describe 'without meta' do
      it 'has empty array' do
        first_document = Nokogiri::HTML('
          <html>
            <body>
              <h1>Mr. Belvedere Fan Club</h1>
            </body>
          </html>
        ')
        second_document = Nokogiri::HTML('')
        expect(MetaInformation.send(:create_meta_array, first_document)).to eq([])
        expect(MetaInformation.send(:create_meta_array, second_document)).to eq([])
      end
    end
  end

  describe 'valid_url?' do
    it 'must be valid' do
      expect(MetaInformation.send(:valid_url?, 'http://www.somesite.com')).to be_truthy
      expect(MetaInformation.send(:valid_url?, 'https://www.somesite.com')).to be_truthy
      expect(MetaInformation.send(:valid_url?, 'https://somesite.com')).to be_truthy
      expect(MetaInformation.send(:valid_url?, 'wwwsome_site.ru')).to be_truthy
      expect(MetaInformation.send(:valid_url?, 'https://somesite.com/some_page')).to be_truthy
      expect(MetaInformation.send(:valid_url?, 'https://somesite.com/some_page/page')).to be_truthy
      expect(MetaInformation.send(:valid_url?, 'https://somesite.com.uk/some_page')).to be_truthy
    end
    
    it 'does not valid' do
      expect(MetaInformation.send(:valid_url?, 'some_site')).to be_falsey
      expect(MetaInformation.send(:valid_url?, 'http\\:wwwsome_site.ru')).to be_falsey
      expect(MetaInformation.send(:valid_url?, 'com.some_site')).to be_falsey
    end
  end
  
  describe 'private hash equal' do
    it 'not_valid_url_error hash' do
      expect(MetaInformation.send(:not_valid_url_error)).to eq({
        success: false,
        error: 'url is not valid'
      })
    end

    it 'nokogiri_error hash' do
      expect(MetaInformation.send(:nokogiri_error)).to eq({
        success: false,
        error: 'error with parsing a document'
      })
    end

    it 'success_hash hash' do
      expect(MetaInformation.send(:success_hash)).to eq({
        succes: 'true',
        error: ''
      })
    end
  end
end
```

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –Ω–∞–ø–∏—Å–∞–Ω, –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω, –Ω–∞—á–∏–Ω–∞–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥–µ–º. –ü—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π .gitignore –∏ –∫–æ–º–º–∏—Ç–∏–º –Ω–∞—à –∫–æ–¥.

```ruby
*.gem
*.rbc
.bundle
.config
.yardoc
usage.rb
Gemfile.lock
InstalledFiles
_yardoc
coverage
doc/
lib/bundler/man
pkg
rdoc
spec/reports
test/tmp
test/version_tmp
tmp
```

–í—ã–∫–ª–∞–¥—ã–≤–∞–µ–º –µ–≥–æ –Ω–∞ github

```bash
git remote add origin git@github.com:USER_NAME/REP_NAME.git
git push -u origin master
```

–°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≥–µ–º–∞ GEM_NAME.gemspec –∫—É–¥–∞ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤–∫–ª—é—á–∞—è –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –≤–µ—Ä—Å–∏—é, —Å—Å—ã–ª–∫–∏, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∏ —Ñ–∞–π–ª—ã.

```ruby
$:.push File.expand_path("../lib", __FILE__)

Gem::Specification.new do |s|
  s.name        = 'meta_information'
  s.version     = '1.0.1'
  s.date        = '2017-02-26'
  s.summary     = 'MetaInformation - Simple gem for parsing meta information'
  s.description = 'Simple gem for parsing meta information from websites. It scan all meta-tags by name or property attributes.'
  s.author      = 'Vladislav Kopylov'
  s.email       = 'kopylov.vlad@gmail.com'
  s.homepage    = 'https://github.com/kopylovvlad/meta_information'
  s.license     = 'MIT'
  s.files       = `git ls-files`.split("\n")
  s.add_dependency('nokogiri', '~> 1.7', '>= 1.7.0')
end
```

–ü—Ä–æ–±—É–µ–º —Å–æ–±—Ä–∞—Ç—å —Å–≤–æ–π –≥–µ–º.

```bash
$ gem build meta_information.gemspec
Successfully built RubyGem
  Name: meta_information
  Version: 1.0.1
  File: meta_information-1.0.1.gem
```

–ü—Ä–æ–≤–µ—Ä–∏–º —É—Å—Ç–∞–Ω–æ–≤–∫—É —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–µ–º–∞.

```bash
$ gem install ./meta_information-1.0.1.gem
Successfully installed meta_information-1.0.1
Parsing documentation for meta_information-1.0.1
Done installing documentation for meta_information after 0 seconds
1 gem installed
```

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏.

```bash
$ irb
2.3.3 :001 > require 'meta_information'
=> true
2.3.3 :002 > MetaInformation::VERSION
=> "1.0.1"
2.3.3 :006 > MetaInformation.get_meta('https://www.yandex.ru‚Äô)
```

–ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–æ –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–ª–∏–≤–∞—Ç—å –≥–µ–º –≤ –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø. –ü–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –∞–≤—Ç–æ—Ä–∏–∑–æ–≤—ã–≤–∞–µ–º—Å—è –≤ [rubygems.org](rubygems.org)

```bash
$ curl -u USER_NAME https://rubygems.org/api/v1/api_key.yaml > ~/.gem/credentials; chmod 0600 ~/.gem/credentials
```

–û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ github

```bash
$ git add ‚Äîall
$ git commit
$ git push origin master
```

–ü—É–±–ª–∏–∫—É–µ–º –≥–µ–º –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω

```bash
$ gem push meta_information-1.0.1.gem
$ gem list -r meta_information
```

–ï—Å–ª–∏ –≤—Å–µ –ø—Ä–æ—à–ª–æ —É–¥–∞—á–Ω–æ, —Ç–æ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –ø—Ä—è–º–æ–π —Å—Å—ã–ª–∫–µ (rubygems.orb/gems/GEM_NAME).

–ü—Ä–∏–º–µ—Ä: [https://rubygems.org/gems/meta_information](https://rubygems.org/gems/meta_information)

–£—Ä–∞, –≥–µ–º —É–¥–∞—á–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω üéâ , —Ç–µ–ø–µ—Ä—å –µ–≥–æ –º–æ–∂–Ω–æ —Å–º–µ–ª–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–æ–π.

```bash
$ gem install meta_information
```

## –î–∞–ª—å–Ω–µ–π—à–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥–µ–º–∞

![image02](image02.jpeg)

–°–æ –≤—Ä–µ–º–µ–Ω–µ–º –∫–∞–∂–¥—ã–π –≥–µ–º —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è, –∫ –Ω–µ–º—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, —É–±–∏—Ä–∞—é—Ç—Å—è –æ—à–∏–±–∫–∏, –Ω–∞ github –ø–æ—è–≤–ª—è—é—Ç—Å—è issues –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ —Ä–µ—à–∏—Ç—å –∏ pull-requests –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ –º–µ—Ä–¥–∂–∏—Ç. –í—Å–µ —ç—Ç–æ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∞–º–∏ –∫ –Ω–æ–≤–æ–º—É —Ä–µ–ª–∏–∑—É. –î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –≤—ã–ª–æ–∂–∏—Ç—å –Ω–æ–≤—ã–π —Ä–µ–ª–∏–∑ –Ω–∞ rubygems, –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è.

–û–±–Ω–æ–≤–∏—Ç—å .gemspecfile. –í –Ω–µ–º –Ω—É–∂–Ω–æ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–Ω–æ–≤–∞ —Å–æ–±—Ä–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≥–µ–º, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏ —Ä–∞–±–æ—Ç—É.

```bash
$ gem build meta_information.gemspec
$ gem install ./meta_information-1.0.2.gem
```

–ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é.

```bash
$ gem push meta_information-1.0.2.gem
```

–í–æ—Ç, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≤—Å–µ. –ù–∏–∂–µ –ø—É–±–ª–∏–∫—É—é –ø–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏ —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.

**Publishing your gem**: [http://guides.rubygems.org/publishing/](http://guides.rubygems.org/publishing/)
**Specification reference**: [http://guides.rubygems.org/specification-reference/](http://guides.rubygems.org/specification-reference/)
